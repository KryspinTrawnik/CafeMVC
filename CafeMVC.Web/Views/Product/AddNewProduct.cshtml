@model CafeMVC.Application.ViewModels.Products.ProductForCreationVm
@{
    string title = "Add new product";
}
<head>
    <link rel="stylesheet" href="~/css/AddProduct.css" />
    <link rel="stylesheet" href="~/css/site.css" />
    <script src="//code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script>

</head>

@using (Html.BeginForm("AddNewProduct", "Product", FormMethod.Post))
{
    <h4>@title</h4>
    <div class="top">
        <div id="container">
            <div id="pictureFrame">
                <div id="displayPicture"></div>
            </div>
        </div>
        <div id="buttonAndName">
            <div id="button">
                <label for="imageUpload" class="btn btn-secondary">Choose file</label>
            </div>
            <input type="file" id="imageUpload" name="files" multiple required style="display: none" />
            <br>
            <h4>Name</h4>
            @Html.TextBoxFor(m => m.Name, new { @class = "textBox" })
            <hr />
        </div>
    </div>
    <div class="bottom">
        <div class="productTable">
            <div class="jeden">
                <div class="allIngredients">
                    <table class="allIngredientsTable">
                        <thead>
                            <tr>
                                <th>Ingredients</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.AllIngredients)
                            {
                                <tr>
                                    <td>
                                        <input type="checkbox" id="@item.Id" style="display:none;" onclick="" />
                                        <label for="@item.Id">@item.Name</label>
                                    </td>
                                    <td>
                                        @item.Checkbox
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div class="buttons">
                    <button type="button" class="btn btn-secondary" >&larr;</button>
                    <button type="button" class="btn btn-secondary" id="returnHighlighted">&rarr;</button>
                </div>
                <div class="productIngredients panel">
                    <table class="productIngredientsTable">
                        <thead>
                            <tr>
                                <th>Product Ingredients</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.Ingredients != null)
                            {
                                @foreach (var item in Model.Ingredients)
                                {
                                    <tr>
                                        <td>
                                            <input type="checkbox" id="@item.Id" style="display:none;" />
                                            <label for="@item.Id">@item.Name</label>
                                        </td>

                                        <td>@item.Checkbox</td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="dwa"> <h4>dwa</h4></div>
            <div class="trzy"> <h4>trzy</h4></div>
        </div>
    </div>
}
@functions {
    private void TickCheckBox(int id)
    {
        var ingredient = Model.AllIngredients.FirstOrDefault(x => x.Id == id);
        if (ingredient != null)
        {
            if (ingredient.Checkbox == false)
            {
                Model.AllIngredients.FirstOrDefault(x => x.Id == id).Checkbox = true;
            }
            else
            {
                Model.AllIngredients.FirstOrDefault(x => x.Id == id).Checkbox = false;
            }
        }
        else
        {
            if (ingredient.Checkbox == false)
            {
                Model.Ingredients.FirstOrDefault(x => x.Id == id).Checkbox = true;
            }
            else
            {
                Model.Ingredients.FirstOrDefault(x => x.Id == id).Checkbox = false;
            }
        }
    }


    private void MoveIngredientsToIngerdient()
    {
        foreach (var item in Model.AllIngredients)
        {

        }
    }

}
@section Scripts{
<script type="text/javascript">
    const image_input = document.querySelector("#imageUpload");
    image_input.addEventListener("change", function () {
        const reader = new FileReader();
        reader.addEventListener("load", () => {
            const uploaded_image = reader.result;
            document.querySelector("#displayPicture").style.backgroundImage = `url(${uploaded_image})`;
        });
        reader.readAsDataURL(this.files[0]);
    });
    $(function () {
        $("input[type=checkbox]").on("change", function () {
            if ($(this).is(':checked'))
                $(this).parent().css('background-color', '#265BFA');
            else
                $(this).parent().css('background-color', '');
        });
    });


</script>

}